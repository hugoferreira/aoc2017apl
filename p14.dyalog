⎕IO←0
p←⊃⊃⎕NGET'p14.txt'1
f←{⊃⊃{a p s←⍵ ⋄ (⌽@(256|p+⍳⍺)⊢a)(p+⍺+s)(s+1)}/(⌽⍵),⊂(⍳256)0 0}
k←{,⍉≠/(8/2)⊤16 16⍴f∊64⍴⊂(⎕UCS ⍵),17 31 73 47 23} ⍝ knot hash, boolean result
a←↑{k p,'-',⍕⍵}¨⍳128
+/,a ⍝ part 1
≢∪0~⍨,{(×⍵)×(1⌽⍵)⌈(¯1⌽⍵)⌈(1⊖⍵)⌈(¯1⊖⍵)⌈⍵}⍣≡0,0,⍨0⍪0⍪⍨a×(⍴a)⍴1+⍳⍴,a ⍝ part 2
