p←⍎¨'\d+'⎕S'&'⊃⎕NGET'p15.txt'1
a←⍬ ⋄ {}{a,←2147483647|16807×⍵}/(40E6/0),⊃p
b←⍬ ⋄ {}{b,←2147483647|48271×⍵}/(40E6/0),⊃⌽p
+/(65536|a)=65536|b ⍝ part 1
+/(65536|5E6↑(0=4|a)/a)=65536|5E6↑(0=8|b)/b ⍝ part 2
