p q←⍎¨'\d+'⎕S'&'⊃⎕NGET'p15.txt'1
a←⍬ ⋄ {a,←2147483647|16807×⍵}⍣40E6⊢p ⋄ a←65536|a
b←⍬ ⋄ {b,←2147483647|48271×⍵}⍣40E6⊢q ⋄ b←65536|b
+/a=b ⍝ part 1
+/(5E6↑a/⍨0=4|a)=(5E6↑b/⍨0=8|b) ⍝ part 2
