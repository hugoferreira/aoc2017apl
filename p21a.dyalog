⎕IO←0
p q←↓⍉'#'=↑∘('[#.]+'⎕S'&')¨↑'[#./]+'⎕S'&'¨⊃⎕NGET'p21.txt'1
p←(⊢,⌽¨)(⊢,⊖¨)(⊢,⍉¨)p ⋄ q←⊃,/8⍴⊂q
tile←{n←⍵⍵÷⍨≢⍵ ⋄ t←0 2 1 3⍉⍺⍺⍤2⊢0 2 1 3⍉n ⍵⍵ n ⍵⍵⍴⍵ ⋄ t⍴⍨2⍴×/2↑⍴t} ⍝ ⍺⍺ on each ⍵⍵×⍵⍵ tile of ⍵
f←{{q⊃⍨p⍳⊂⍵}tile(2+2|≢⍵)⊢⍵}
pat←'#'=3 3⍴'.#...####'
+/,f⍣5⊢pat ⍝ part 1
+/,f⍣18⊢pat ⍝ part 2
