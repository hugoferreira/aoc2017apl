⎕IO←0
p←'#'=↑⊃⎕NGET'p22.txt'1
a←1025 1025↑¯525 ¯525↑p ⋄ z←0 ⋄ z⊣{p d←⍵ ⋄ d←(2 2⍴0 ¯1 1 0)+.×d×¯1*p⌷a ⋄ z+←(p⌷a)←~p⌷a ⋄ (p+d)d}⍣10000⊢(⌊0.5×⍴a)(¯1 0) ⍝ part 1
a←1025 1025↑¯525 ¯525↑2×p ⋄ z←0 ⋄ z⊣{p d←⍵ ⋄ d←(2 2⍴0 1 ¯1 0)∘(+.×)⍣(4|¯1+p⌷a)⊢d ⋄ z+←2=(p⌷a)←4|1+p⌷a ⋄ (p+d)d}⍣10000000⊢(⌊0.5×⍴a)(¯1 0) ⍝ part 2
